name: automatically assign reviewers

on:
  schedule:
    - cron: "37 0 * * *" # At 00:37 UTC every day
  push:

jobs:
  autoassign-reviewers:
    name: assign automatically proposed reviewers
    runs-on: ubuntu-latest
    steps:
      - name: download auto-assignments
        run: |
          curl --output assignments.json https://leanprover-community.github.io/queueboard/automatic_assignments.json

      # The Hoskinson runners may not have jq installed, so do that now.
      - name: 'Setup jq'
        uses: dcarbone/install-jq-action@f0e10f46ff84f4d32178b4b76e1ef180b16f82c3 # v3.1.1

      # Parse the json file
      - name: parse assignments file and assign reviewers
        run: |
          python3 write_assignments.py
          echo "Wrote assignment file 'assign_users.sh'"
          chmod u+x assign_users.sh
          echo 'File contents are:'
          cat assign_users.sh
          ./assign_users.sh
