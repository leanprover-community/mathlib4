/-
Copyright (c) 2023 Scott Carnahan. All rights reserved.
Released under Apache 2.0 license as described in the file LICENSE.
Authors: Scott Carnahan
-/
module

public import Mathlib.Algebra.Vertex.Basic
public import Mathlib.Algebra.Lie.Loop

/-!
# Vertex algebras attached to affine Lie algebras
Given a Lie algebra `L` over a commutative ring `R`, a central extension `C → g → L[z,z⁻¹]`, and a
positive-energy representation `V` of `g` with fixed central character `χ: C → R` we define vertex
operators on `V` attached to elements of `L`.  We show that they are local, so `V` is a module for
the vertex algebra they generate.  Special cases include Heisenberg vertex algebras for abelian `L`,
and the vacuum representations of affine Kac-Moody algebras.

## Definitions
* `vertexOperator x V` : the vertex operator for `x` on `V`.
* `vertexAlgebra χ g` : the vertex algebra generated by fields.

## Main results
* The fields are mutually local.
* The fields satisfy reconstruction conditions
* Any positive-energy module `g` at `χ` is a module for `vertexAlgebra χ g` -- needs def of VA mods.

## To do:
Write defs and proofs.  First, write something in the loop Lie algebra file.

## References
* R. Borcherds, "Vertex algebras, Kac-Moody algebras, and the monster" PNAS (1986)
* E. Frenkel, D. Ben-Zvi, "Vertex Algebras and Algebraic Curves" AMS monographs (2004)
-/

@[expose] public section

variable {R L M : Type*}

section LoopAlgebra

/-
/-- A representation has positive energy if the energy spectrum is non-negative. -/
class positiveEnergy [CommRing R] [IsAddTorsionFree R] [LieRing L] [LieAlgebra R L] [AddCommGroup M]
    [Module R M] (Φ : LinearMap.BilinForm R L) (hΦ : LinearMap.BilinForm.lieInvariant L Φ)
    (hΦs : LinearMap.BilinForm.IsSymm Φ)
    [LieRingModule (LieAlgebra.LoopAlgebra.extension R ℤ L Φ hΦ hΦs).L M] where
  locally_finite_rank : ∀m : M, Module.rank R
-/

--def affineVertexOperator (x : g) (V : positiveEnergy) : VertexOperator R V :=
--  of_coeff R fun n v => x t^n • v

end LoopAlgebra

section VertexAlgebra

--def vacuumModule g χ

end VertexAlgebra
